(function(s,a){typeof exports=="object"&&typeof module<"u"?a(exports):typeof define=="function"&&define.amd?define(["exports"],a):(s=typeof globalThis<"u"?globalThis:s||self,a(s.ScoreboardManager={}))})(this,function(s){"use strict";var p=Object.defineProperty;var M=(s,a,r)=>a in s?p(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r;var d=(s,a,r)=>M(s,typeof a!="symbol"?a+"":a,r);class a{constructor(){d(this,"matches",new Map)}save(e){this.matches.set(e.id,e)}remove(e){this.matches.delete(e)}findById(e){return this.matches.get(e)}findByTeams(e,n){return Array.from(this.matches.values()).find(o=>o.homeTeam===e&&o.awayTeam===n||o.homeTeam===n&&o.awayTeam===e)}getAll(){return Array.from(this.matches.values())}}const r=[];for(let t=0;t<256;++t)r.push((t+256).toString(16).slice(1));function g(t,e=0){return(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase()}let c;const y=new Uint8Array(16);function S(){if(!c){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");c=crypto.getRandomValues.bind(crypto)}return c(y)}const u={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function l(t,e,n){var i;if(u.randomUUID&&!t)return u.randomUUID();t=t||{};const o=t.random??((i=t.rng)==null?void 0:i.call(t))??S();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,g(o)}function b(t,e){if(!t.trim()||!e.trim())throw new Error("Both home team and away team names are required");if(t===e)throw new Error("Home team and away team cannot be the same");return{homeTeam:t,awayTeam:e,homeScore:0,awayScore:0,startTime:new Date}}function f(t,e,n){if(!Number.isSafeInteger(e)||!Number.isSafeInteger(n))throw new Error("Scores must be safe integers");if(e<0||n<0)throw new Error("Scores cannot be negative");return{...t,homeScore:e,awayScore:n}}function h(t){return t.homeScore+t.awayScore}class w{constructor(e){d(this,"_scoreboardStorage");this._scoreboardStorage=e||new a}startMatch(e,n){if(this._scoreboardStorage.findByTeams(e,n))throw Error("A match with these teams already exists");const i={id:l(),...b(e,n)};return this._scoreboardStorage.save(i),i}updateScore(e,n,o){const i=this.getMatchById(e),m=f(i,n,o);return this._scoreboardStorage.save(m),m}finishMatch(e){return this.getMatchById(e),this._scoreboardStorage.remove(e),!0}getSummary(){return this._scoreboardStorage.getAll().toSorted((n,o)=>{const i=h(o)-h(n);return i!==0?i:o.startTime.getTime()-n.startTime.getTime()})}getAllMatches(){return this._scoreboardStorage.getAll()}getMatchById(e){const n=this._scoreboardStorage.findById(e);if(!n)throw new Error("A match with this ID doesn't exist");return n}findMatch(e,n){return this._scoreboardStorage.findByTeams(e,n)}}s.InMemoryScoreboardStorage=a,s.ScoreboardManager=w,Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});
